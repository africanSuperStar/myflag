<template>
  <div>
    <div class="mf-background-container">
      <mf-nav-bar></mf-nav-bar>
      <div class="container-fluid h-75 contact">
        <div class="row px-2 justify-content-end">
          <div class="col-lg-2">Address: Southdowns Ridge</div>
          <div class="col-lg-3">Office hours: Mon – Friday; 08h30 – 16h00</div>
          <div class="col-lg-2">Contact Number: 0835028866</div>
        </div>
      </div>
      <div class="hero-caption pt-5">
        <div class="container h-75">
          <div class="row align-items-center h-100">
            <div class="col-lg-6 wow fadeInUp">
              <h1 class="mb-4">The Start of New Financial Beginnings</h1>
              <p class="mb-4">
                <b>myflag</b> specializes in professional liquidation,
                sequestration and rehabilitation of both individuals and
                businesses. Our dedicated legal and support team have more than
                a decade of experience and specialise in insolvency matters.
              </p>
              <b-button to="/apply-online" class="btn bg-primary rounded-pill"
                >Apply Online</b-button
              >
            </div>
            <div class="col-lg-6 pl-4 py-3 align-self-center">
              <div
                class="img-fluid img-thumbnail mobile-preview shadow floating-animate"
              >
                <cld-image
                  cloudName="myflag"
                  class="undraw"
                  publicId="undraw_wallet_svfsgf"
                  alt="wallet"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Services -->
    <div class="page-section mt-5">
      <div class="container">
        <div class="row justify-content-center align-items-start">
          <h2 class="mb-4">Services</h2>
        </div>
        <div class="row align-items-start">
          <div class="col-sm-12 col-lg-4 pt-4 pb-7">
            <a href="/liquidation">
              <div
                class="img-fluid"
                data-aos="zoom-in"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="300"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <h5 class="services-title">Liquidation</h5>
                <cld-image
                  cloudName="myflag"
                  class="liquidity"
                  publicId="liquidity_tvxduo"
                  crop="scale"
                  alt="liquidation"
                  width="450"
                />
                <p class="services-title pt-7">
                  Liquidation is a legal process by which a legal entity is
                  closed down, because the business has become insolvent.
                </p>
              </div>
            </a>
          </div>
          <div class="col-sm-6 col-lg-4 pt-4">
            <a href="/sequestration">
              <div
                class="img-fluid"
                data-aos="zoom-in"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="300"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <h5 class="services-title">Sequestration</h5>
                <cld-image
                  cloudName="myflag"
                  class="sequestration"
                  publicId="revenue_grrpgw"
                  crop="scale"
                  alt="sequestration"
                  width="450"
                />
                <p class="services-title pt-7">
                  Sequestration is declaring yourself insolvent/bankrupt through
                  a High Court application under the Insolvency Act.
                </p>
              </div>
            </a>
          </div>
          <div class="col-sm-6 col-lg-4 pt-4">
            <a href="/rehabilitation">
              <div
                class="img-fluid"
                data-aos="zoom-in"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="300"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <h5 class="services-title pb-5">Rehabilitation</h5>
                <cld-image
                  cloudName="myflag"
                  class="rehabilitation"
                  publicId="budget_dd9rej"
                  crop="scale"
                  alt="sequestration"
                  width="450"
                />
                <p class="services-title pt-4">
                  Rehabilitation is the legal process by which an Insolvent (a
                  sequestrated individual) is relieved of the legal implications
                  of being an Insolvent and restored to the legal status of a
                  credit worthy consumer (a “solvent”).
                </p>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
    <!-- End services -->

    <div class="page-section pt-0">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 d-none d-lg-block wow">
            <div
              class="img-fluid img-thumbnail mobile-preview shadow floating-animate"
            >
              <cld-image
                cloudName="myflag"
                class="undraw"
                publicId="undraw_receipt_mpune0"
                alt="receipt"
              />
            </div>
          </div>
          <div class="col-lg-6 py-3 mt-lg-5">
            <div class="iconic-list">
              <h1 class="mb-4">We can assist you if</h1>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item">
                  <div
                    class="iconic-sm iconic-text bg-warning fg-white rounded-circle"
                  >
                    <span class="mai-cube"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>You are not able to pay all your debt</h5>
                    <p class="fs-small">
                      If your liabilities (debt) exceeds your assets.
                    </p>
                  </div>
                </div>
              </div>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item">
                  <div
                    class="iconic-sm iconic-text bg-info fg-white rounded-circle"
                  >
                    <span class="mai-shield"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>Other debt relief options are not possible for you</h5>
                    <p class="fs-small">
                      If you find yourself without any other options. We can
                      help you.
                    </p>
                  </div>
                </div>
              </div>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item wow fadeInUp">
                  <div
                    class="iconic-sm iconic-text bg-indigo fg-white rounded-circle"
                  >
                    <span class="mai-desktop-outline"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>Continuing losses and insufficient capital</h5>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="page-section pb-0">
        <div class="container">
          <div class="row">
            <div class="col-lg-6 offset-lg-1 pb-7 mt-lg-5 wow fadeInUp">
              <h1 class="mb-4">We can also help with</h1>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item wow fadeInUp">
                  <div
                    class="iconic-sm iconic-text bg-warning fg-white rounded-circle"
                  >
                    <span class="mai-cube"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>Series of creditors issuing legal proceedings</h5>
                  </div>
                </div>
              </div>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-in-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item wow fadeInUp">
                  <div
                    class="iconic-sm iconic-text bg-info fg-white rounded-circle"
                  >
                    <span class="mai-shield"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>Shortfall of payments on your assets</h5>
                  </div>
                </div>
              </div>
              <div
                data-aos="fade-up"
                data-aos-offset="0"
                data-aos-delay="0"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
                data-aos-mirror="false"
                data-aos-once="true"
                data-aos-anchor-placement="top-center"
              >
                <div class="iconic-item wow fadeInUp">
                  <div
                    class="iconic-sm iconic-text bg-indigo fg-white rounded-circle"
                  >
                    <span class="mai-desktop-outline"></span>
                  </div>
                  <div class="iconic-content">
                    <h5>Lack of severe cashflow</h5>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-5 pt-5">
              <div
                class="img-fluid img-thumbnail mobile-preview shadow floating-animate"
              >
                <cld-image
                  cloudName="myflag"
                  class="undraw"
                  publicId="undraw_personal_finance_xnpkrw"
                  alt="personal finance"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="page-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-7 mb-lg-0 d-none d-lg-block">
            <div
              class="img-fluid img-thumbnail mobile-preview shadow floating-animate"
            >
              <cld-image
                cloudName="myflag"
                class="undraw"
                publicId="undraw_modern_professional_fqxse3"
                alt="young professional"
              />
            </div>
          </div>
          <div class="col-lg-5">
            <h1 class="wow fadeInUp">
              Need serious help? <br />
              Don't worry just contact us
            </h1>

            <b-form id="apply-now-form" class="row" @submit.prevent="onSubmit">
              <div class="col-sm-12">
                <b-form-group class="form-group">
                  <label for="name">Full Name</label>
                  <b-form-input
                    id="name-input-1"
                    name="name-input-1"
                    v-model="$v.form.name.$model"
                    :state="validateState('name')"
                    aria-describedby="input-1-live-feedback"
                  ></b-form-input>

                  <b-form-invalid-feedback id="input-1-live-feedback"
                    >Please provide a name.</b-form-invalid-feedback
                  >
                </b-form-group>

                <b-form-group class="form-group">
                  <label for="mobile_number">Mobile Number</label>
                  <b-form-input
                    id="mobile-input-2"
                    name="mobile-input-2"
                    v-model="$v.form.mobile_number.$model"
                    :state="validateState('mobile_number')"
                    aria-describedby="input-2-live-feedback"
                  ></b-form-input>

                  <b-form-invalid-feedback id="input-2-live-feedback"
                    >Please provide a mobile number.</b-form-invalid-feedback
                  >
                </b-form-group>

                <b-form-group class="form-group">
                  <label for="from_email">Email Address</label>
                  <b-form-input
                    id="email-input-3"
                    name="email-input-3"
                    v-model="$v.form.from_email.$model"
                    :state="validateState('from_email')"
                    aria-describedby="input-3-live-feedback"
                  ></b-form-input>

                  <b-form-invalid-feedback id="input-3-live-feedback"
                    >Please provide an email address.</b-form-invalid-feedback
                  >
                </b-form-group>

                <div class="form-group">
                  <label for="message">Message</label>
                  <textarea
                    class="form-control"
                    type="message"
                    v-model="$v.message"
                    name="message"
                    aria-describedby="message"
                    rows="5"
                  ></textarea>
                </div>
              </div>
              <div class="container">
                <div class="row justify-content-md-center">
                  <div class="col col-lg-4 mt-5">
                    <vue-recaptcha
                      ref="invisibleRecaptcha"
                      @verify="onVerify"
                      @expired="onExpired"
                      size="invisible"
                      :sitekey="sitekey"
                      :loadRecaptchaScript="true"
                    />
                    <b-button
                      type="submit"
                      class="btn bg-primary rounded-pill g-recaptcha"
                    >
                      Contact Us
                    </b-button>
                  </div>
                </div>
              </div>
            </b-form>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import VueRecaptcha from "vue-recaptcha";
import { validationMixin } from "vuelidate";
import { required, minLength, numeric } from "vuelidate/lib/validators";

import axios from "axios";

import MfNavBar from "@/components/MfNavBar";

export default {
  name: "home",
  components: {
    "mf-nav-bar": MfNavBar,
    "vue-recaptcha": VueRecaptcha,
  },
  metaInfo: {
    title: "myflag - Home Page",
    titleTemplate: "%s ← myflag",
    meta: [
      { "http-equiv": "Content-Type", content: "text/html; charset=utf-8" },
      { name: "viewport", content: "width=device-width, initial-scale=1" },
      {
        name: "description",
        content: "The Start of New Financial Beginnings.",
      },
      { property: "og:title", content: "myflag - Home Page" },
      { property: "og:site_name", content: "myflag" },
      // The list of types is available here: http://ogp.me/#types
      { property: "og:type", content: "website" },
      // Should the the same as your canonical link, see below.
      {
        property: "og:url",
        content: "https://myflag.co.za/",
      },
      {
        property: "og:image",
        content: "https://myflag.co.za/img/myflag-logo.dcfb8be4.png",
      },
      {
        property: "og:description",
        content: "The Start of New Financial Beginnings.",
      },

      // Google / Schema.org markup:
      { itemprop: "name", content: "myflag - Home Page" },
      {
        itemprop: "description",
        content: "The Start of New Financial Beginnings.",
      },
      {
        itemprop: "image",
        content: "https://myflag.co.za/img/myflag-logo.dcfb8be4.png",
      },
    ],
  },
  mixins: [validationMixin],
  data() {
    return {
      sitekey: "6Ld2jU0aAAAAAEXdlq4I3QzrLBcrOyjHWrGz6qys",
      recaptchaVerified: "false",
      message: null,
      form: {
        name: null,
        mobile_number: null,
        from_email: null,
      },
    };
  },
  validations: {
    form: {
      name: {
        required,
        minLength: minLength(1),
      },
      mobile_number: {
        required,
        minLength: minLength(1),
        numeric,
      },
      from_email: {
        required,
        minLength: minLength(1),
      },
    },
  },
  methods: {
    validateState(name) {
      const { $dirty, $error } = this.$v.form[name];
      return $dirty ? !$error : null;
    },
    resetForm() {
      this.$nextTick(() => {
        this.$v.$reset();
      });
    },
    sendMail() {
      console.log("Recaptcha Verified!");
      if (this.recaptchaVerified === "true") {
        console.log("Recaptcha Verified and sending email!!");
        console.log("Sending Email...");

        const body = {
          message: this.$v.message,
          form: {
            name: this.$v.form.name.$model,
            mobile_number: this.$v.form.mobile_number.$model,
            from_email: this.$v.form.from_email.$model,
          },
        };
        axios
          .post(
            "https://us-central1-myflag-za.cloudfunctions.net/contactUs",
            body
          )
          .then(function () {
            console.log("Successfully sent email");
          })
          .catch(function () {
            console.log("Failed to send email.");
          });

        this.resetRecaptcha();
        this.recaptchaVerified = "false";
      }
    },
    onSubmit() {
      this.$v.form.$touch();
      console.log(this.$v.form.$anyError);
      if (this.$v.form.$anyError) {
        return;
      } else {
        this.$refs.invisibleRecaptcha.execute();
        this.resetForm();
      }
    },
    onVerify() {
      console.log("SENDING EMAIL...");
      console.log("Verify Recaptcha");
      this.recaptchaVerified = "true";
      this.sendMail();
    },
    onExpired() {
      console.log("Expired");
    },
    resetRecaptcha() {
      console.log("Reset Recaptcha");
      this.$refs.invisibleRecaptcha.reset();
    },
  },
};
</script>

<style lang="scss" scoped>
a:visited {
  color: #3a3542;
}

.contact {
  color: #000;
  background-color: #c7c7c7;
}

.undraw {
  overflow: inherit;
  width: 50%;
  transform: scale(0.35) translate(-10em, -20em);
}

.services-title {
  text-align: center;
}

.liquidity {
  display: block;
  margin: auto;
  overflow: inherit;
  height: 100px;
  width: 20%;
  transform: scale(0.25) translateX(-12.5em);
}

.rehabilitation {
  display: block;
  margin: auto;
  overflow: inherit;
  height: 100px;
  width: 20%;
  transform: scale(0.25) translateX(-12.5em) translateY(-12.75em);
}

.sequestration {
  display: block;
  margin: auto;
  overflow: inherit;
  height: 100px;
  width: 20%;
  transform: scale(0.2) translateX(-12.5em);
}

.btn {
  padding: 0.4rem 0.5rem;
  align-self: start;
  margin: auto;
}

.btn-secondary:hover {
  color: #fff;
}
</style>